{% extends "cosinnus_poll/base.html" %}
{% load i18n static cosinnus_tags widget_tweaks thumbnail %}

{% block page_title %}
	{% if form_view == "add" %}
	  {% trans "Add poll" %}
	{% elif form_view == "edit" %}
	  {% trans "Edit" %} {{ poll.title }}
	{% endif %}
{{ block.super }}
{% endblock page_title %}

{% block breadcrumb %}
        {{ block.super }}
        <li class="active">
	        {% if form_view == "add" %}
			  {% trans "Add poll" %}
			{% elif form_view == "edit" %}
			  {% trans "Edit" %} {{ poll.title }}
			{% endif %}
        </li>
{% endblock %}

{% block leftnav %}
    {% include "cosinnus_poll/leftnav.html" with return_to="polls"%}
{% endblock leftnav %}

{% block content %}

    <!-- a box with semi transparent background -->
	<div class="content-box">
	   <form method="POST" action="">{% csrf_token %}
			{% for formset in inlines %}
		    	{{ formset.management_form }}
		    {% endfor %}
		    
		    <div type="button" class="btn btn-default w100 large-space">
		        <ul class="media-list">
		            <li class="media">
		                <a class="pull-left btn-emphasized" href="#">
		                    <i class="fa fa-plus"></i>
		                </a>
		                <div class="media-body media-body-form-control">
		                    {{ form.forms.obj.non_field_errors }}
                            {{ form.forms.media_tag.non_field_errors }}
		                    
		                    {{ form.forms.obj.title.errors }}
	                        {% captureas placeholder %}{% trans "Enter a title for the new poll." %}{% endcaptureas %}
                            {% if request.GET.title %}
                                {% render_field form.forms.obj.title class+="form-control" placeholder=placeholder value=request.GET.title %}
                            {% else %}
                                {% render_field form.forms.obj.title class+="form-control" placeholder=placeholder %}
	                        {% endif %}
	                        
	                        <ol class="input-area">
                                <li class="w100">
                                    {{ form.forms.obj.description.errors }}
		                            {% captureas placeholder %}{% trans "Enter a description for the poll (optional)." %}{% endcaptureas %}
		                            {% render_field form.forms.obj.description class+="form-control" placeholder=placeholder %}
                                </li>
                            </ol>
                            
                            
	                        {% include 'cosinnus/media_tags.html' %}
                            
                            
		                </div>
		            </li>
		            
		        </ul>
		    </div>
		    
		    <div type="button" class="btn btn-default w100 large-space">
		        <ul class="media-list">
		             
				    {% with option_formset=inlines.0 %}
						{% for inlineform in option_formset %}
							
							<li class="media no-margin" id="options-wrapper-{{ forloop.counter0 }}" {% if not forloop.counter == 1 and not forloop.counter <= option_formset.management_form.initial.INITIAL_FORMS %}style="display: none;"{% endif %}>
				                <a class="pull-left btn-emphasized" href="#">
				                    <i class="fa fa-question"></i>
				                </a>
				                <div class="media-body media-body-form-control {% if forloop.last %}regular-space{% else %}fine-space{% endif %}">
						            	
						            	<div class="media">
						            		<div class="form-control">
						            			<label style="padding: 5px;">{% trans "Edit Poll Option" %}&nbsp;{{ forloop.counter }}&nbsp;&nbsp;&nbsp;<em>{% trans "Write a description or select an image" %}</em></label>
					            			</div>
						                    <a class="pull-left">
							 					<i class="fa fa-edit"></i>
											</a>
											<div class="media-body media-body-form-control">
							                    {% captureas placeholder %}{% trans "Description" %}{% endcaptureas %}
								                {{ inlineform.description.errors }}
								                {% render_field inlineform.description class+="form-control" style+="height: 72px; padding: 7px 10px 5px 10px;" placeholder=placeholder %}
								            </div>
											<a class="pull-left">
												{% if inlineform.image.value %}
													<img class="image" src="{% thumbnail inlineform.image.value 40x40 crop=1 upscale=1 %}"></img>
												{% else %}
								 					<i class="fa fa-image"></i>
												{% endif %}
											</a>
											<div style="padding: 0px 10px; display: inline-block;">
								                {% captureas placeholder %}{% trans "Choose and upload an image" %}{% endcaptureas %}
								                {{ inlineform.image.errors }}
								                {% render_field inlineform.image class+="form-control" placeholder=placeholder %}
								                
												<div>
													<i>{% trans "File Size" %}: {% trans "max. 10 MB" %}</i>
													&nbsp;&nbsp;&nbsp;&nbsp;
													
													<label for="{{ inlineform.DELETE.id_for_label }}">{% trans "Delete" %}:</label>
													{{ inlineform.DELETE }}
												</div>
								            </div>
								            
								            
								        </div>
										{{ inlineform.poll }}
										{{ inlineform.id }}
						            </div>
								</li>
								
								{% if forloop.counter >= option_formset.management_form.initial.INITIAL_FORMS and forloop.counter < option_formset.management_form.initial.MAX_NUM_FORMS %}
									<div id="options-more-{{ forloop.counter0 }}" {% if not forloop.counter == 1 and not forloop.counter <= option_formset.management_form.initial.INITIAL_FORMS %}style="display: none;"{% endif %}>
										
										<button class="btn btn-emphasized pull-left no-margin" onclick="$('#options-more-{{ forloop.counter0 }}').hide(); $('#options-wrapper-{{ forloop.counter }}').show(); $('#options-more-{{ forloop.counter }}').show(); return false;">
									        <ul class="media-list">
									            <li class="media">
									                <a class="pull-left" href="#">
									                    <i class="fa fa-plus"></i>
									                </a>
									                <div class="media-body">
										                {% trans "Add option" %}
									                </div>
									            </li>
									        </ul>
									    </button>
									    
									</div>
								{% endif %}
						{% endfor %}
					{% endwith %}
						
		        </ul>
		    </div>
		
		    <button type="submit" class="btn btn-emphasized" id="createDoodleButton">
		        <ul class="media-list">
		            <li class="media">
		                <a class="pull-left" href="#">
		                    <i class="fa fa-pencil"></i>
		                </a>
		                <div class="media-body">
		                    {% if form_view == "add" %}
				              {% trans "Create" %}
				            {% elif form_view == "edit" %}
				              {% trans "Save" %}
				            {% endif %}
		                </div>
		            </li>
		        </ul>
		    </button>
	   
        </form>
	
	</div><!-- content-box -->
    
{% endblock content %}
